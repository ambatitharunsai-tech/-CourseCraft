<!DOCTYPE html>
<html lang="en" class="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GenAI Curriculum Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        brand: {
                            light: '#5eead4', // teal-300
                            DEFAULT: '#0d9488', // teal-600
                            dark: '#0f766e', // teal-700
                        }
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-out forwards',
                        'spin-slow': 'spin 2s linear infinite',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0', transform: 'translateY(10px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        /* Modern Scrollbar */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        .dark ::-webkit-scrollbar-thumb { background: #334155; }
        ::-webkit-scrollbar-thumb:hover { background: #0d9488; }

        /* Print Specific Styles */
        @media print {
            body { background: white !important; color: black !important; display: block !important; }
            #sidebar, .no-print { display: none !important; }
            #mainContent { 
                width: 100% !important; 
                margin: 0 !important; 
                padding: 0 !important; 
                overflow: visible !important;
                height: auto !important;
            }
            .print-break { page-break-inside: avoid; margin-bottom: 2rem !important; }
            h1, h2, h3, h4, p, li, span { color: black !important; }
            .print-border { border: 1px solid #e2e8f0 !important; }
            .print-bg-white { background: white !important; }
        }
    </style>
</head>
<body class="bg-slate-50 dark:bg-slate-950 text-slate-800 dark:text-slate-200 transition-colors duration-300 h-screen w-full flex flex-col md:flex-row overflow-hidden font-sans">
    
    <!-- Sidebar / Control Panel -->
    <aside id="sidebar" class="w-full md:w-80 lg:w-96 bg-white dark:bg-slate-900 border-r border-slate-200 dark:border-slate-800 flex flex-col h-auto md:h-full flex-shrink-0 z-20 shadow-[4px_0_24px_rgba(0,0,0,0.02)]">
        <div class="p-6 md:p-8 flex-1 overflow-y-auto">
            
            <!-- Branding -->
            <div class="flex justify-between items-start mb-8">
                <div>
                    <div class="flex items-center gap-3 mb-1">
                        <div class="w-8 h-8 rounded-lg bg-brand text-white flex items-center justify-center shadow-md shadow-brand/30">
                            <i class="fas fa-layer-group text-sm"></i>
                        </div>
                        <h1 class="text-xl font-bold tracking-tight text-slate-900 dark:text-white">GenAI <span class="text-brand">Paths</span></h1>
                    </div>
                    <p class="text-xs text-slate-500 dark:text-slate-400 font-medium">Curriculum Architect</p>
                </div>
                <button id="themeToggle" class="p-2 rounded-lg bg-slate-100 dark:bg-slate-800 hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300 transition-colors">
                    <i class="fas fa-moon hidden dark:block text-sm"></i>
                    <i class="fas fa-sun block dark:hidden text-sm"></i>
                </button>
            </div>

            <!-- Configuration Form -->
            <form id="curriculumForm" class="space-y-6">
                <!-- Stream -->
                <div class="space-y-2">
                    <label class="text-xs font-bold uppercase tracking-wider text-slate-500 dark:text-slate-400">Core Subject</label>
                    <input type="text" id="stream" placeholder="e.g. Prompt Engineering..." required
                        class="w-full px-4 py-2.5 bg-slate-50 dark:bg-slate-950 border border-slate-200 dark:border-slate-800 rounded-lg focus:ring-2 focus:ring-brand/50 focus:border-brand transition-all outline-none text-sm text-slate-900 dark:text-white placeholder-slate-400">
                    
                    <!-- Quick Links -->
                    <div class="flex flex-wrap gap-2 mt-2">
                        <button type="button" onclick="document.getElementById('stream').value='LLM Apps'; document.getElementById('stream').focus();" class="text-[10px] px-2 py-1 rounded bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:text-brand transition-colors">LLM Apps</button>
                        <button type="button" onclick="document.getElementById('stream').value='AI Agents'; document.getElementById('stream').focus();" class="text-[10px] px-2 py-1 rounded bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:text-brand transition-colors">AI Agents</button>
                        <button type="button" onclick="document.getElementById('stream').value='Computer Vision'; document.getElementById('stream').focus();" class="text-[10px] px-2 py-1 rounded bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:text-brand transition-colors">Vision</button>
                    </div>
                </div>

                <!-- Duration -->
                <div class="space-y-2">
                    <label class="text-xs font-bold uppercase tracking-wider text-slate-500 dark:text-slate-400">Timeline</label>
                    <div class="relative">
                        <select id="duration" required
                            class="w-full pl-4 pr-10 py-2.5 bg-slate-50 dark:bg-slate-950 border border-slate-200 dark:border-slate-800 rounded-lg focus:ring-2 focus:ring-brand/50 focus:border-brand transition-all outline-none text-sm text-slate-900 dark:text-white appearance-none cursor-pointer">
                            <option value="" disabled selected>Select timeline duration</option>
                            <option value="3 Months">3 Months (Intensive Bootcamp)</option>
                            <option value="6 Months">6 Months (Standard Track)</option>
                            <option value="1 Year">1 Year (Deep Specialization)</option>
                        </select>
                        <div class="absolute inset-y-0 right-0 pr-4 flex items-center pointer-events-none">
                            <i class="fas fa-chevron-down text-slate-400 text-xs"></i>
                        </div>
                    </div>
                </div>

                <!-- Skill Level -->
                <div class="space-y-2">
                    <label class="text-xs font-bold uppercase tracking-wider text-slate-500 dark:text-slate-400">Target Audience</label>
                    <div class="relative">
                        <select id="level" required
                            class="w-full pl-4 pr-10 py-2.5 bg-slate-50 dark:bg-slate-950 border border-slate-200 dark:border-slate-800 rounded-lg focus:ring-2 focus:ring-brand/50 focus:border-brand transition-all outline-none text-sm text-slate-900 dark:text-white appearance-none cursor-pointer">
                            <option value="" disabled selected>Select starting proficiency</option>
                            <option value="Beginner">Beginner (No prior experience)</option>
                            <option value="Intermediate">Intermediate (Some background)</option>
                            <option value="Advanced">Advanced (Requires deep dive)</option>
                        </select>
                        <div class="absolute inset-y-0 right-0 pr-4 flex items-center pointer-events-none">
                            <i class="fas fa-chevron-down text-slate-400 text-xs"></i>
                        </div>
                    </div>
                </div>

                <!-- Submit Action -->
                <div class="pt-4">
                    <button type="submit" id="generateBtn" class="w-full py-3 px-4 bg-slate-900 hover:bg-slate-800 dark:bg-brand dark:hover:bg-brand-dark text-white font-medium text-sm rounded-lg shadow-md transition-all flex items-center justify-center gap-2">
                        <i class="fas fa-bolt text-amber-400 dark:text-white"></i> Build Architecture
                    </button>
                </div>
            </form>

            <!-- Export Actions (Hidden initially) -->
            <div id="actionButtons" class="hidden flex-col gap-3 mt-8 pt-8 border-t border-slate-200 dark:border-slate-800 animate-fade-in no-print">
                <p class="text-xs font-bold uppercase tracking-wider text-slate-500 dark:text-slate-400 mb-1">Export Options</p>
                <button onclick="window.print()" class="w-full py-2.5 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-700 dark:text-slate-200 font-medium text-sm rounded-lg border border-slate-200 dark:border-slate-700 transition-colors flex items-center justify-center gap-2 shadow-sm">
                    <i class="fas fa-print"></i> Save as PDF
                </button>
                <button onclick="copyToClipboard()" id="copyBtn" class="w-full py-2.5 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-700 dark:text-slate-200 font-medium text-sm rounded-lg border border-slate-200 dark:border-slate-700 transition-colors flex items-center justify-center gap-2 shadow-sm">
                    <i class="fab fa-markdown"></i> Copy Markdown
                </button>
                <button onclick="location.reload()" class="w-full py-2.5 mt-2 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-950/30 font-medium text-sm rounded-lg transition-colors flex items-center justify-center gap-2">
                    <i class="fas fa-undo"></i> Reset Canvas
                </button>
            </div>
        </div>
    </aside>

    <!-- Main Content Area -->
    <main id="mainContent" class="flex-1 h-full overflow-y-auto bg-slate-50 dark:bg-slate-950 relative">
        
        <!-- Empty State -->
        <div id="emptyState" class="absolute inset-0 flex flex-col items-center justify-center p-8 text-center opacity-100 transition-opacity duration-500">
            <div class="w-24 h-24 mb-6 rounded-full bg-slate-100 dark:bg-slate-900 border border-slate-200 dark:border-slate-800 flex items-center justify-center text-slate-300 dark:text-slate-700">
                <i class="fas fa-project-diagram text-4xl"></i>
            </div>
            <h2 class="text-xl font-semibold text-slate-800 dark:text-slate-200 mb-2">Workspace Ready</h2>
            <p class="text-sm text-slate-500 dark:text-slate-400 max-w-sm">Configure your parameters in the sidebar to dynamically generate a structured curriculum architecture.</p>
        </div>

        <!-- Loader State -->
        <div id="loader" class="hidden absolute inset-0 flex-col items-center justify-center p-8 text-center bg-slate-50/80 dark:bg-slate-950/80 backdrop-blur-sm z-10 no-print">
            <i class="fas fa-circle-notch text-4xl text-brand animate-spin-slow mb-6"></i>
            <h3 class="text-lg font-medium text-slate-900 dark:text-white mb-2">Assembling Nodes</h3>
            <p id="loaderText" class="text-sm text-slate-500 dark:text-slate-400 max-w-sm transition-opacity duration-300">Querying intelligence models...</p>
        </div>

        <!-- Result Canvas -->
        <div id="printArea" class="hidden w-full max-w-4xl mx-auto p-6 md:p-12 pb-24">
            <div id="resultContainer" class="animate-fade-in">
                <!-- Data injected here -->
            </div>
        </div>
    </main>

    <script>
        // --- Theme Management ---
        const themeToggle = document.getElementById('themeToggle');
        const htmlElement = document.documentElement;
        
        // Auto-detect system preference
        if (localStorage.getItem('theme') === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            htmlElement.classList.add('dark');
        } else {
            htmlElement.classList.remove('dark');
        }

        themeToggle.addEventListener('click', () => {
            htmlElement.classList.toggle('dark');
            localStorage.setItem('theme', htmlElement.classList.contains('dark') ? 'dark' : 'light');
        });

        // --- Mock Data Generator ---
        function generateMockData(stream, duration) {
            const months = parseInt(duration);
            let totalModules = months === 3 ? 3 : (months === 6 ? 6 : 12);
            
            let curriculum = {};
            for(let i = 1; i <= totalModules; i++) {
                curriculum[`Phase ${i}: ${i <= totalModules/3 ? 'Core Foundations' : (i <= (totalModules*2/3) ? 'Advanced Execution' : 'Mastery & Scale')}`] = [
                    {
                        course_title: `${stream} Theory & Mechanics`,
                        course_description: `A deep dive into the underlying architecture and theoretical framework required to master ${stream}.`,
                        topics: [
                            `Fundamentals of ${stream}`,
                            "Data pipelines and structuring",
                            "Algorithmic evaluation metrics",
                            "Ethical considerations and bias"
                        ]
                    },
                    {
                        course_title: `Applied Engineering Workshop`,
                        course_description: `Practical, hands-on labs where theoretical concepts are translated into working prototypes.`,
                        topics: [
                            "Setting up the dev environment",
                            "Building the V1 prototype",
                            "Debugging and optimization"
                        ]
                    }
                ];
            }
            return curriculum;
        }

        const apiKey = ""; // API Key provided automatically by the execution environment
        let rawGeneratedData = null; 

        async function generateRealData(stream, duration, level) {
            const endpoint = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            const prompt = `Act as a senior curriculum architect. Design a highly structured, professional curriculum for ${stream}. The timeframe is ${duration} and the target skill level is ${level}. Return an organized set of phases/semesters containing courses, short technical descriptions, and specific bulleted topics.`;
            
            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
                systemInstruction: {
                    parts: [{ text: "You must return ONLY valid JSON matching the schema. No markdown wrapping. Be technical, structured, and practical." }]
                },
                generationConfig: {
                    responseMimeType: "application/json",
                    responseSchema: {
                        type: "OBJECT",
                        properties: {
                            curriculum: {
                                type: "OBJECT",
                                description: "Keys should be the Phase or Month (e.g. 'Phase 1: Foundations'). Values are arrays of courses.",
                                additionalProperties: {
                                    type: "ARRAY",
                                    items: {
                                        type: "OBJECT",
                                        properties: {
                                            course_title: { type: "STRING" },
                                            course_description: { type: "STRING", description: "Brief technical description of the course." },
                                            topics: {
                                                type: "ARRAY",
                                                items: { type: "STRING" }
                                            }
                                        },
                                        required: ["course_title", "course_description", "topics"]
                                    }
                                }
                            }
                        },
                        required: ["curriculum"]
                    }
                }
            };

            for (let i = 0; i < 5; i++) {
                try {
                    const response = await fetch(endpoint, {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify(payload)
                    });
                    
                    if (!response.ok) throw new Error(`API request failed with status ${response.status}`);
                    
                    const result = await response.json();
                    const jsonText = result.candidates?.[0]?.content?.parts?.[0]?.text;
                    if (!jsonText) throw new Error("Invalid response format");
                    
                    const parsed = JSON.parse(jsonText);
                    return parsed.curriculum;
                } catch (error) {
                    if (i === 4) throw error;
                    await new Promise(r => setTimeout(r, Math.pow(2, i) * 1000));
                }
            }
        }

        // --- Form Submission Logic ---
        document.getElementById('curriculumForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const stream = document.getElementById('stream').value;
            const duration = document.getElementById('duration').value;
            const level = document.getElementById('level').value;
            
            // UI State Changes
            const btn = document.getElementById('generateBtn');
            const originalBtnHtml = btn.innerHTML;
            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            
            document.getElementById('emptyState').classList.add('hidden');
            document.getElementById('printArea').classList.add('hidden');
            document.getElementById('loader').classList.remove('hidden');
            document.getElementById('loader').classList.add('flex');

            // Dynamic Loader Text
            const loadingMessages = [
                "Querying intelligence models...",
                "Structuring logical pathways...",
                "Defining core modules...",
                "Finalizing document architecture..."
            ];
            let msgIndex = 0;
            const loaderTextSpan = document.getElementById('loaderText');
            loaderTextSpan.innerText = loadingMessages[0];
            const loadInterval = setInterval(() => {
                msgIndex = (msgIndex + 1) % loadingMessages.length;
                loaderTextSpan.style.opacity = '0';
                setTimeout(() => {
                    loaderTextSpan.innerText = loadingMessages[msgIndex];
                    loaderTextSpan.style.opacity = '1';
                }, 300);
            }, 2000);

            try {
                let generatedData;
                if (apiKey) {
                    generatedData = await generateRealData(stream, duration, level);
                } else {
                    await new Promise(r => setTimeout(r, 3500)); // Simulate delay
                    generatedData = generateMockData(stream, duration);
                }
                
                rawGeneratedData = { stream, duration, level, curriculum: generatedData };
                renderCurriculum(stream, duration, generatedData, level);
                
                // Reset UI
                clearInterval(loadInterval);
                document.getElementById('loader').classList.add('hidden');
                document.getElementById('loader').classList.remove('flex');
                document.getElementById('printArea').classList.remove('hidden');
                document.getElementById('actionButtons').classList.remove('hidden');
                document.getElementById('actionButtons').classList.add('flex');
                
                // On mobile, scroll down to the content automatically
                if(window.innerWidth < 768) {
                    document.getElementById('mainContent').scrollIntoView({ behavior: 'smooth' });
                }

            } catch (error) {
                console.error(error);
                clearInterval(loadInterval);
                document.getElementById('loader').classList.add('hidden');
                document.getElementById('loader').classList.remove('flex');
                const container = document.getElementById('resultContainer');
                container.innerHTML = `
                    <div class="p-6 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-center">
                        <i class="fas fa-exclamation-circle text-red-500 text-3xl mb-3"></i>
                        <h3 class="text-red-800 dark:text-red-400 font-bold">Generation Failed</h3>
                        <p class="text-sm text-red-600 dark:text-red-300 mt-1">Unable to construct architecture. Check API key or console.</p>
                    </div>`;
                document.getElementById('printArea').classList.remove('hidden');
            } finally {
                btn.disabled = false;
                btn.innerHTML = originalBtnHtml;
            }
        });

        // --- Copy to Clipboard Logic ---
        function copyToClipboard() {
            if (!rawGeneratedData) return;
            
            let markdown = `# Architecture: ${rawGeneratedData.stream}\n`;
            markdown += `> **Duration:** ${rawGeneratedData.duration} | **Proficiency:** ${rawGeneratedData.level}\n\n`;
            
            for (const [semester, courses] of Object.entries(rawGeneratedData.curriculum)) {
                markdown += `## ${semester}\n\n`;
                courses.forEach(course => {
                    markdown += `### ${course.course_title}\n`;
                    if (course.course_description) markdown += `_${course.course_description}_\n\n`;
                    course.topics.forEach(topic => {
                        markdown += `- ${topic}\n`;
                    });
                    markdown += `\n`;
                });
            }

            const onSuccess = () => {
                const copyBtn = document.getElementById('copyBtn');
                const originalHtml = copyBtn.innerHTML;
                copyBtn.innerHTML = '<i class="fas fa-check text-green-500"></i> Copied to Clipboard';
                setTimeout(() => { copyBtn.innerHTML = originalHtml; }, 2000);
            };

            if (navigator.clipboard && window.isSecureContext) {
                navigator.clipboard.writeText(markdown).then(onSuccess);
            } else {
                let textArea = document.createElement("textarea");
                textArea.value = markdown;
                document.body.appendChild(textArea);
                textArea.select();
                try { document.execCommand('copy'); onSuccess(); } catch (err) { console.error(err); }
                document.body.removeChild(textArea);
            }
        }

        // --- Render Function (Flat Dashboard Cards) ---
        function renderCurriculum(stream, duration, data, level) {
            const container = document.getElementById('resultContainer');
            
            // Generate Header
            let html = `
                <div class="mb-10 print-border print-bg-white print:p-6 print:rounded-lg border-b border-slate-200 dark:border-slate-800 pb-8">
                    <p class="text-brand font-bold tracking-wider uppercase text-xs mb-2">Curriculum Architecture</p>
                    <h2 class="text-3xl md:text-4xl font-extrabold text-slate-900 dark:text-white mb-4 tracking-tight">${stream}</h2>
                    <div class="flex flex-wrap items-center gap-3">
                        <span class="px-3 py-1 bg-slate-100 dark:bg-slate-800 text-slate-700 dark:text-slate-300 rounded-md text-xs font-semibold border border-slate-200 dark:border-slate-700"><i class="far fa-clock mr-1.5"></i>${duration}</span>
                        <span class="px-3 py-1 bg-slate-100 dark:bg-slate-800 text-slate-700 dark:text-slate-300 rounded-md text-xs font-semibold border border-slate-200 dark:border-slate-700"><i class="fas fa-signal mr-1.5"></i>${level} Track</span>
                    </div>
                </div>
                <div class="space-y-12">
            `;

            for (const [semester, courses] of Object.entries(data)) {
                html += `
                    <div class="print-break">
                        <div class="flex items-center gap-4 mb-6">
                            <h3 class="text-xl font-bold text-slate-800 dark:text-white">${semester}</h3>
                            <div class="flex-1 h-px bg-slate-200 dark:bg-slate-800"></div>
                        </div>
                        
                        <div class="grid grid-cols-1 gap-6">
                `;

                courses.forEach((course, index) => {
                    html += `
                            <div class="bg-white dark:bg-slate-900 p-6 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm print-border print-bg-white relative overflow-hidden group">
                                <div class="absolute left-0 top-0 bottom-0 w-1 bg-brand opacity-50 group-hover:opacity-100 transition-opacity"></div>
                                
                                <div class="flex flex-col md:flex-row md:items-start gap-4 md:gap-8">
                                    <div class="md:w-1/3">
                                        <h4 class="text-lg font-bold text-slate-900 dark:text-white mb-2 leading-tight">${course.course_title}</h4>
                                        ${course.course_description ? `<p class="text-sm text-slate-500 dark:text-slate-400 leading-relaxed">${course.course_description}</p>` : ''}
                                    </div>
                                    
                                    <div class="md:w-2/3 bg-slate-50 dark:bg-slate-950/50 p-4 rounded-lg border border-slate-100 dark:border-slate-800 print-border">
                                        <ul class="space-y-2.5">
                    `;
                    
                    course.topics.forEach(topic => {
                        html += `
                                            <li class="text-slate-700 dark:text-slate-300 text-sm flex items-start gap-3">
                                                <i class="fas fa-check-circle text-brand/70 mt-0.5 text-[10px]"></i>
                                                <span class="leading-tight">${topic}</span>
                                            </li>
                        `;
                    });

                    html += `
                                        </ul>
                                    </div>
                                </div>
                            </div>
                    `;
                });

                html += `
                        </div>
                    </div>
                `;
            }

            html += `</div>`;
            container.innerHTML = html;
        }
    </script>
</body>
</html>